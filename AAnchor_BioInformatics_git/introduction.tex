Atomic accuracy models of protein structures are an invaluable tool for the elucidation of protein function.  The recent "resolution revolution" \cite{kuhlbrandt2014resolution} in cryo electron microscopy (cryoEM) has led to an ever increasing number of near atomic resolution density maps deposited in the EM databank EMDB \cite{Lawson2016EMDataBank3DEM}.  While in 2002 the best structure deposited was at $9 \AA$ resolution, recently (\cite{Bartesaghi20152.2Inhibitor,Banerjee20162.3Inhibition}) key structures have been resolved at resolution better than $2.5 \AA$ .

Most of the techniques for modeling protein structures into intermediate resolution ($5 - 10 \;\AA$) maps are based on rigid fitting of template protein structures into these maps.  Many of these methods (\cite{Jiang2001,lasker2007ematch,Yu2008,Rusu2012,Si2012}) use secondary structures as anchors for their fitting procedure. 

At resolutions better than $4-5 \AA$, the goal is more ambitious and de novo modeling techniques are being exploited. Some of them are adaptations of the standard X-ray crystallography modeling methods, however these tend to be time consuming. Recently, several de-novo modeling techniques have been developed to deal specifically with cryoEM density maps\cite{DiMaio2016}.  Pathwalking \cite{Chen2016} detects first pseudo-atom anchors and then applies the travelling salesperson (TSP) combinatorial optimization algorithm to detect a long enough path which should model the protein backbone. 
MAINMAST \cite{Terashi2018} detects a set of anchor points and calculates the backbone by applying  a minimun spanning tree (MST) approach.
A recently published method \cite{wang2015novo}  fits short sequence based structure fragment templates into the density map and applies a Monte Carlo simulated annealing procedure to detect a set of mutually compatible fragments.  All of the above mentioned procedures require prior segmentation of the density map into its various protein chains.

Prior detection of reliable {\bf amino acid anchors} in the density map, namely having knowledge of even a relatively small number of amino acids, whose identity and location has been established with high confidence 
can be used to guide the various de-novo modeling methods, as well as serve as a starting point for the development of novel methods. In particular, it could lead to the development of novel techniques, which do not require prior segmentation of the EM density map.   While in high resolution maps (roughly, $3.5 \;\AA$ or better), sidechains become  visible and individual rotamers may be distinguished (\cite{DiMaio2016},\cite{Cassidy2018}), no automated method has been suggested to detect specific amino acids in a cryo-EM density map.

In this work we present a machine learning (ML) algorithm nicknamed {\bf AAnchor} (amino-acid anchor) for the detection and localization of amino acids in a high resolution cryo EM density map. 
The two primary goals of this study are 
(i) to develop an automatic tool for the detection and classification of amino acids in a near atomic resolution cryo EM map; and 
(ii) to provide a quantitative analysis of the ability to detect a specific amino acid in an experimental cryo EM map.


The preliminary results of our algorithm are quite encouraging.
For example, on the $3.1 \AA$ cryo EM map of lysenin pore \cite{Bokori-Brown2016Cryo-EMProtein}, the algorithm localizes above one hundred amino acids of different types with confidence above $80 \%$.
These preliminary results also indicate that the quality of detection is best for amino acids, which have a small number of rotamers and a large enough training set.  This last observation also explains why
contrary to expectation the results for  $2.9  \AA$ and $3.1 \;\AA$ resolution maps are better then those for $2.2 \;\AA$ maps. This is due to the limited training data set existing for the better resolution maps.  Thus, with the rapid increase in high resolution cryoEM structures and the availability of larger trainng sets, the results of our machine learning based methodology are expected to improve significantly.

A server of the detection/prediction stage of the  AAnchor algorithm is available at \url{http://bioinfo3d.cs.tau.ac.il/AAnchor/}.  










